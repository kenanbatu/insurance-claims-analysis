---
title: "Exploratory Analysis"
jupyter: python3
format:
  html:
    toc: true
---

## Distributions of Key Numerical Features

We begin our exploratory data analysis by looking at the distributions of three important
numerical variables:

- **Customer age**
- **Vehicle age**
- **Subscription length**

These histograms help us understand the spread and central tendencies of key features that
later play a role in the model.

![](images/num_feature_distributions.png)

**What we observe:**

- Customer ages are mostly concentrated in a working-age range.  
- Vehicle age is skewed toward newer cars.  
- Subscription length varies widely and later appears as a strong predictor.

---

## Claim Rates Across Categories

This visualization compares claim rates across:

- **Fuel type**  
- **Region density**  
- **Vehicle segment**

![](images/categorical_claim_rates.png)

**Insights:**

- Some fuel types show slightly higher claim risk.  
- Claim rates increase in higher-density regions.  
- Certain vehicle segments consistently have higher claim frequencies.

---

## Regional Claim Differences

We also examine geographic variation in claims.

![](images/region_claim_rates.png)

**Interpretation:**

- Claim behavior varies meaningfully across regions.  
- Some regions exceed 10% claim rate while others sit closer to 4%.  
- Geography is therefore an important predictor in our model.

---

## Subscription Length and Claim Behavior

![](images/subscription_length_vs_claim.png)

**We observe:**

- Longer subscription durations correlate with higher claim rates.  
- This reflects accumulated exposure time and helps explain why subscription length
  appears as a top feature in the model.

---

## Interactive: Claim Rates by Region

The visualization below is a fully interactive version of regional claim behavior.
You can hover over points to see:

- Claim rate (percentage)  
- Number of policies in that region  
- Average customer age  
- Population density  

This interactive chart allows a more detailed exploration of geographic patterns.

### Interactive Plot

```{python}
#| label: interactive-claim-rates-by-region
#| echo: false
#| warning: false
#| message: false

import pandas as pd
import plotly.express as px

# IMPORTANT: update this path to where your CSV actually lives inside the site folder
df = pd.read_csv("insurance_claims.csv")

region_summary = df.groupby('region_code').agg({
    'claim_status': ['mean', 'count'],
    'customer_age': 'mean',
    'region_density': 'first'
}).reset_index()

region_summary.columns = ['region', 'claim_rate', 'policies', 'avg_age', 'density']
region_summary['claim_pct'] = region_summary['claim_rate'] * 100

fig = px.scatter(
    region_summary,
    x='policies', y='claim_pct',
    size='policies',
    color='claim_pct',
    hover_name='region',
    hover_data={'policies':':,', 'claim_pct':':.2f', 'avg_age':':.1f'},
    title='Interactive: Claim Rates by Region',
    size_max=30,
    height=500
)

fig.show()

<iframe src="images/claim_rates_by_region.html" width="100%" height="560" style="border:none;"></iframe>